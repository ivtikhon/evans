---
domain: EC2
  # Here we define classes, or types of objects
  # and dependencies that exists on the class level
  classes:
    - instance:
        states:
          - created
          - running
          - terminated
        actions:
          - launch
          - start
          - stop
          - terminate
    - volume:
        states:
          created: 'created'
          attached: 'attached'
        actions:
          create:
            effect:
              add_state: volume.states.created
          attach:
            precondition:
              - ${self}.states['created']
              - instance.states.created
              # and exists object that requires volume attached
            effect:
              add_state: 'attached'
          detach:
            effect:
              remove_state: 'attached'

    - filesystem:
        states:
          created:
          mounted:
        actions:
          create:

 # Here we define object and their dependencies
  objects:
    - instance:
      - inst1
    - volume:
        - vol1
